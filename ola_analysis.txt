SELECT * FROM ola.bookings;

-- Q1 Retrieve all successuful bookings;

select * from bookings where Booking_Status = 'success'

-- Q2 Find the average ride distance for each vehicle type:
select 
     Vehicle_Type,
     
	 avg(Ride_Distance) as avg_distance
from bookings
group by Vehicle_Type    

-- Q3 Get the total number of canceled rides by customers:
select count(*) from bookings 
where Booking_status = 'Canceled by Customer';

-- Q4 List the top 5 Customers who booked the highest number of rides:

select Customer_ID, count(Booking_ID) as total_rides
from bookings
group by Customer_ID
order by total_rides desc limit 5;

-- Q5 Get the number of rides canceled by drivers due to personal and car-related issues:

select count(*) from bookings 
 where Canceled_Rides_by_Driver ='Personal & Car related issue'

-- Q6 Find the maximum and minimum driver ratings for Prime Sedan Bookings:     

select Max(Driver_Ratings) as max_rating,
Min(Driver_Ratings) as min_rating
from bookings Where Vehicle_Type = 'Prime Sedan';

-- Q7 Retrives all rides where payment was made using UPI;
select * from bookings where payment_method = 'UPI'

--  Q8 find the average cusotmer rating per vehicle type:
select  
     vehicle_type,
     avg(customer_rating) as avg_rating
from bookings
group by vehicle_type

-- Q9 calculate the total booking value of rides completed successsfully;
select 
     Booking_status,
     sum(Booking_value) as total_value 
from bookings     
where Booking_status = 'success'

-- Q10 List all  incomplete rides along with the reason:
select
    booking_id,
    incomplete_rides_reason
from bookings
where incomplete_rides = 'yes'
